<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes and Edit</title>
    <link rel="stylesheet" href="F:\develop\Cotes\assets\css\notes-and-edit.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

</head>
<body>

    <div class="notes-page">
        <div class="container">
            <h1>My Notes</h1>
            <div class="notes-grid" id="notes-container">
                </div>

            <button class="btn" id="add-note-button">Add Note</button>
        </div>
    </div>

    <div class="confirm-modal" id="delete-modal">
        <div class="confirm-dialog">
            <p class="confirm-text">Are you sure you want to delete this note?</p>
            <div class="confirm-buttons">
                <button class="btn danger" id="confirm-delete">Delete</button>
                <button class="btn" id="cancel-delete">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        const notesContainer = document.getElementById('notes-container');
        const addNoteButton = document.getElementById('add-note-button');
        const deleteModal = document.getElementById('delete-modal');
        const confirmDeleteButton = document.getElementById('confirm-delete');
        const cancelDeleteButton = document.getElementById('cancel-delete');

        let notes = JSON.parse(localStorage.getItem('notes')) || [];

        function saveNotes() {
            localStorage.setItem('notes', JSON.stringify(notes));
        }

        function displayNotes() {
            notesContainer.innerHTML = ''; // Clear existing notes

            notes.forEach((note, index) => {
                const noteCard = document.createElement('div');
                noteCard.classList.add('note-card');
                noteCard.dataset.index = index;  // Store index for easy access

                const title = document.createElement('h3');
                title.textContent = note.title || "Untitled Note"; // Handle missing titles
                noteCard.appendChild(title);

                const content = document.createElement('p');
                content.textContent = note.content;
                noteCard.appendChild(content);

                const deleteButton = document.createElement('button');
                deleteButton.classList.add('delete-button');
                deleteButton.addEventListener('click', (event) => {
                    event.stopPropagation(); // Prevent card click
                    deleteModal.style.display = 'flex';
                    deleteModal.dataset.index = index; // Store index of note to delete

                });
                noteCard.appendChild(deleteButton);

                noteCard.addEventListener('click', () => {
                    window.location.href = `note.html?index=${index}`;
                });

                notesContainer.appendChild(noteCard);
            });
        }

        addNoteButton.addEventListener('click', () => {
             window.location.href = 'edit-note.html'; // Redirect to the editor page
        });

        confirmDeleteButton.addEventListener('click', () => {
            const indexToDelete = deleteModal.dataset.index;
            notes.splice(indexToDelete, 1);
            saveNotes();
            displayNotes();
            deleteModal.style.display = 'none';
        });

        cancelDeleteButton.addEventListener('click', () => {
            deleteModal.style.display = 'none';
        });

        displayNotes(); // Initial display of notes


    </script>

</body>
</html>